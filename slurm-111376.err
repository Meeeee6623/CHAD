/home/pl217/miniconda3/envs/simpler_env/lib/python3.11/site-packages/huggingface_hub/file_download.py:896: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/pl217/continualearning/model.py:630: UserWarning: Weight loading missing non-Hopfield keys: ['out_head.weight']
  if missing: warnings.warn(f"Weight loading missing non-Hopfield keys: {missing}")
/home/pl217/continualearning/model.py:266: UserWarning: Error assigning sampled embeddings (shape mismatch?): shape '[24, 256, 128]' is invalid for input of size 18874368. Falling back to random.
  warnings.warn(f"Error assigning sampled embeddings (shape mismatch?): {e}. Falling back to random.")
Downloading data:   0%|          | 0/24 [00:00<?, ?files/s]Downloading data:   4%|▍         | 1/24 [00:01<00:34,  1.48s/files]Downloading data:   8%|▊         | 2/24 [00:08<01:44,  4.74s/files]Downloading data:  12%|█▎        | 3/24 [00:20<02:48,  8.04s/files]Downloading data: 100%|██████████| 24/24 [00:20<00:00,  1.17files/s]
Generating train split:   0%|          | 0/32747 [00:00<?, ? examples/s]Generating train split:   3%|▎         | 1000/32747 [00:00<00:31, 1013.68 examples/s]Generating train split:   7%|▋         | 2365/32747 [00:02<00:29, 1025.79 examples/s]Generating train split:   8%|▊         | 2730/32747 [00:04<00:53, 562.37 examples/s] Generating train split:  11%|█▏        | 3730/32747 [00:06<01:00, 478.34 examples/s]Generating train split:  13%|█▎        | 4095/32747 [00:08<01:10, 407.56 examples/s]Generating train split:  16%|█▌        | 5095/32747 [00:09<00:53, 513.45 examples/s]Generating train split:  17%|█▋        | 5460/32747 [00:10<01:02, 435.84 examples/s]Generating train split:  20%|█▉        | 6460/32747 [00:12<00:51, 511.62 examples/s]Generating train split:  24%|██▍       | 7825/32747 [00:15<00:54, 454.70 examples/s]Generating train split:  28%|██▊       | 9190/32747 [00:17<00:46, 502.19 examples/s]Generating train split:  32%|███▏      | 10555/32747 [00:19<00:39, 563.19 examples/s]Generating train split:  33%|███▎      | 10920/32747 [00:21<00:47, 455.40 examples/s]Generating train split:  36%|███▋      | 11920/32747 [00:22<00:37, 559.23 examples/s]Generating train split:  38%|███▊      | 12285/32747 [00:22<00:32, 632.03 examples/s]Generating train split:  41%|████      | 13285/32747 [00:25<00:37, 513.44 examples/s]Generating train split:  45%|████▍     | 14650/32747 [00:27<00:30, 589.10 examples/s]Generating train split:  46%|████▌     | 15015/32747 [00:29<00:38, 461.29 examples/s]Generating train split:  49%|████▉     | 16015/32747 [00:30<00:30, 552.52 examples/s]Generating train split:  50%|█████     | 16379/32747 [00:31<00:34, 480.61 examples/s]Generating train split:  53%|█████▎    | 17379/32747 [00:33<00:28, 533.14 examples/s]Generating train split:  57%|█████▋    | 18743/32747 [00:36<00:28, 487.44 examples/s]Generating train split:  61%|██████▏   | 20107/32747 [00:37<00:20, 608.60 examples/s]Generating train split:  63%|██████▎   | 20471/32747 [00:39<00:25, 475.34 examples/s]Generating train split:  66%|██████▌   | 21471/32747 [00:40<00:20, 539.30 examples/s]Generating train split:  70%|██████▉   | 22835/32747 [00:44<00:20, 481.52 examples/s]Generating train split:  74%|███████▍  | 24199/32747 [00:45<00:14, 581.35 examples/s]Generating train split:  75%|███████▌  | 24563/32747 [00:47<00:18, 435.09 examples/s]Generating train split:  78%|███████▊  | 25563/32747 [00:49<00:14, 484.63 examples/s]Generating train split:  82%|████████▏ | 26927/32747 [00:52<00:12, 449.42 examples/s]Generating train split:  86%|████████▋ | 28291/32747 [00:54<00:08, 529.89 examples/s]Generating train split:  88%|████████▊ | 28655/32747 [00:56<00:09, 428.50 examples/s]Generating train split:  91%|█████████ | 29655/32747 [00:58<00:06, 454.86 examples/s]Generating train split:  92%|█████████▏| 30019/32747 [00:59<00:06, 418.32 examples/s]Generating train split:  95%|█████████▍| 31019/32747 [01:00<00:03, 537.01 examples/s]Generating train split:  99%|█████████▉| 32383/32747 [01:03<00:00, 516.03 examples/s]Generating train split: 100%|██████████| 32747/32747 [01:04<00:00, 506.39 examples/s]
Generating test split:   0%|          | 0/10557 [00:00<?, ? examples/s]Generating test split:   9%|▉         | 1000/10557 [00:00<00:07, 1227.77 examples/s]Generating test split:  22%|██▏       | 2320/10557 [00:02<00:07, 1136.23 examples/s]Generating test split:  25%|██▌       | 2640/10557 [00:03<00:13, 598.91 examples/s] Generating test split:  34%|███▍      | 3640/10557 [00:05<00:11, 625.41 examples/s]Generating test split:  47%|████▋     | 4960/10557 [00:09<00:12, 454.48 examples/s]Generating test split:  59%|█████▉    | 6280/10557 [00:11<00:08, 479.70 examples/s]Generating test split:  72%|███████▏  | 7600/10557 [00:13<00:05, 576.41 examples/s]Generating test split:  75%|███████▌  | 7919/10557 [00:14<00:05, 455.52 examples/s]Generating test split:  84%|████████▍ | 8919/10557 [00:17<00:03, 453.48 examples/s]Generating test split:  97%|█████████▋| 10238/10557 [00:19<00:00, 481.08 examples/s]Generating test split: 100%|██████████| 10557/10557 [00:20<00:00, 516.10 examples/s]
Generating validation split:   0%|          | 0/3461 [00:00<?, ? examples/s]Generating validation split:  29%|██▉       | 1000/3461 [00:00<00:02, 1104.31 examples/s]Generating validation split:  62%|██████▏   | 2154/3461 [00:01<00:01, 1189.24 examples/s]Generating validation split:  67%|██████▋   | 2308/3461 [00:03<00:02, 514.79 examples/s] Generating validation split:  96%|█████████▌| 3308/3461 [00:04<00:00, 622.26 examples/s]Generating validation split: 100%|██████████| 3461/3461 [00:05<00:00, 577.57 examples/s]
Traceback (most recent call last):
  File "/home/pl217/continualearning/train.py", line 433, in <module>
    train(config_file)
  File "/home/pl217/continualearning/train.py", line 275, in train
    train_dataloader = get_dataloader(config, tokenizer, split="train")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/pl217/continualearning/data_loader.py", line 201, in get_dataloader
    dataset = NarrativeQADataset(config, tokenizer, split=split)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/pl217/continualearning/data_loader.py", line 42, in __init__
    self._processed_data = self._create_training_instances()
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/pl217/continualearning/data_loader.py", line 50, in _create_training_instances
    for idx, example in enumerate(tqdm(self.dataset, desc=f"Processing {self.split}")):
                                  ^^^^
NameError: name 'tqdm' is not defined
